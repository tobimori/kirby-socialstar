(function(){"use strict";function u(){return window.panel}const s=window.Vue;s.computed,s.customRef,s.defineAsyncComponent,s.defineComponent,s.effectScope,s.getCurrentInstance,s.getCurrentScope,s.h,s.inject,s.isProxy,s.isReactive,s.isReadonly,s.isRef,s.isShallow,s.markRaw,s.nextTick,s.onActivated,s.onBeforeMount,s.onBeforeUnmount,s.onBeforeUpdate,s.onDeactivated,s.onErrorCaptured,s.onMounted,s.onRenderTracked,s.onRenderTriggered,s.onScopeDispose,s.onServerPrefetch,s.onUnmounted,s.onUpdated,s.provide,s.proxyRefs,s.reactive,s.readonly;const _=s.ref;s.shallowReactive,s.shallowReadonly,s.shallowRef,s.toRaw,s.toRef,s.toRefs,s.triggerRef,s.unref,s.useAttrs,s.useCssModule,s.useCssVars,s.useListeners,s.useSlots,s.watch,s.watchEffect,s.watchPostEffect,s.watchSyncEffect;const c={name:[Number,String]};function r(o,e,t,n,a,i,p,f){var l=typeof o=="function"?o.options:o;return e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),{exports:o,options:l}}const m={__name:"ConnectorBase",props:{hasAuthCredentials:Boolean,isConnected:Boolean,service:String,isLoading:Boolean,...c},emits:["connect","disconnect","refresh"],setup(o,{emit:e}){return{__sfc:!0,props:o,emit:e}}};var v=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return e.isConnected?t("k-field",{attrs:{label:e.$t(`socialstar.${e.service}.account`)}},[t("div",{staticClass:"star-account"},[e._t("default"),t("div",{staticClass:"star-account_actions"},[t("k-button",{attrs:{size:"sm",theme:"green",variant:"filled",icon:e.isLoading?"loader":"download",disabled:e.isLoading},on:{click:function(a){return n.emit("refresh")}}},[e._v(" "+e._s(e.isLoading?e.$t("socialstar.loading"):e.$t("socialstar.loadNewPosts"))+" ")]),t("k-button",{attrs:{size:"sm",variant:"filled",theme:"error",icon:"logout"},on:{click:function(a){return n.emit("disconnect")}}},[e._v(" "+e._s(e.$t("socialstar.disconnect"))+" ")])],1)],2)]):t("k-field",e._b({staticClass:"star-connect-account",class:{"has-error":!e.hasAuthCredentials}},"k-field",n.props,!1),[t("div",{staticClass:"star-connect-account_wrapper"},[t("k-icon",{attrs:{type:e.service}}),e.hasAuthCredentials?t("span",[e._v(e._s(e.$t(`socialstar.${e.service}.connectAccount`)))]):t("span",[e._v(e._s(e.$t(`socialstar.${e.service}.missingApiCredentials`)))])],1),t("k-button",{attrs:{size:"sm",variant:"filled",icon:"check",theme:e.hasAuthCredentials?"pink":"error",disabled:!e.hasAuthCredentials},on:{click:function(a){return n.emit("connect")}}},[e._v(" "+e._s(e.$t("socialstar.connect"))+" ")])],1)},h=[],g=r(m,v,h);const d=g.exports,b={__name:"InstagramConnector",props:{hasAuthCredentials:Boolean,authUrl:String,userDetails:Object,...c},setup(o){const e=o,t=()=>{window.location.href=e.authUrl},n=u(),a=_(!1);return{__sfc:!0,props:e,openAuthUrl:t,panel:n,isLoading:a,loadNewPosts:()=>{a.value=!0,n.api.get(`${n.view.path}/fields/${e.name}/update`).then(()=>{a.value=!1,n.reload()})},disconnect:()=>{n.dialog.open({component:"k-remove-dialog",props:{text:n.t("socialstar.instagram.disconnectConfirm")},on:{submit:()=>{n.api.get(`${n.view.path}/fields/${e.name}/remove-auth`).then(()=>{n.reload()}),n.dialog.close()}}})},name:c,ConnectorBase:d}}};var C=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.ConnectorBase,{attrs:{service:"instagram",isConnected:!!e.userDetails,hasAuthCredentials:e.hasAuthCredentials,isLoading:n.isLoading},on:{connect:n.openAuthUrl,disconnect:n.disconnect,refresh:n.loadNewPosts}},[e.userDetails?[t("img",{staticClass:"star-instagram_avatar",attrs:{src:e.userDetails.profile_picture_url}}),t("div",{staticClass:"star-instagram_content"},[t("a",{staticClass:"star-instagram_name",attrs:{href:`https://instagram.com/${e.userDetails.username}`,target:"_blank"}},[t("span",[e._v(e._s(e.userDetails.name))]),t("strong",[e._v("@"+e._s(e.userDetails.username))])]),t("ul",[t("li",[t("k-icon",{attrs:{type:"images"}}),e._v(" "+e._s(e.$t("socialstar.instagram.posts",{count:e.userDetails.media_count}))+" ")],1),t("li",[t("k-icon",{attrs:{type:"users"}}),e._v(" "+e._s(e.$t("socialstar.instagram.followers",{count:e.userDetails.followers_count}))+" ")],1),t("li",[t("k-icon",{attrs:{type:"star-outline"}}),e._v(" "+e._s(e.$t("socialstar.instagram.follows",{count:e.userDetails.follows_count}))+" ")],1)])])]:e._e()],2)},$=[],w=r(b,C,$);const y=w.exports,k={__name:"YouTubeConnector",props:{hasAuthCredentials:Boolean,userDetails:Object,...c},setup(o){const e=o;console.log(e.userDetails);const t=u(),n=()=>{t.dialog.open({component:"k-form-dialog",props:{fields:{username:{label:t.t("socialstar.youtube.connectUser"),before:"@",required:!0,type:"text"}}},on:{submit:f=>{t.api.post(`${t.view.path}/fields/${e.name}/connect`,f).then(()=>{t.reload()}),t.dialog.close()}}})},a=()=>{t.dialog.open({component:"k-remove-dialog",props:{text:t.t("socialstar.youtube.disconnectConfirm")},on:{submit:()=>{t.api.post(`${t.view.path}/fields/${e.name}/disconnect`).then(()=>{t.reload()}),t.dialog.close()}}})},i=_(!1);return{__sfc:!0,props:e,panel:t,connect:n,disconnect:a,isLoading:i,refresh:()=>{i.value=!0,t.api.get(`${t.view.path}/fields/${e.name}/update`).then(()=>{i.value=!1,t.reload()})},ConnectorBase:d}}};var R=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.ConnectorBase,{attrs:{service:"youtube",isConnected:!!e.userDetails,hasAuthCredentials:e.hasAuthCredentials,isLoading:n.isLoading},on:{connect:n.connect,disconnect:n.disconnect,refresh:n.refresh}},[e.userDetails?[t("img",{staticClass:"star-instagram_avatar",attrs:{src:e.userDetails.snippet.thumbnails.high.url}}),t("div",{staticClass:"star-instagram_content"},[t("a",{staticClass:"star-instagram_name",attrs:{href:`https://youtube.com/${e.userDetails.snippet.customUrl}`,target:"_blank"}},[t("span",[e._v(e._s(e.userDetails.snippet.title))]),t("strong",[e._v(e._s(e.userDetails.snippet.customUrl))])]),t("ul",[t("li",[t("k-icon",{attrs:{type:"youtube"}}),e._v(" "+e._s(e.$t("socialstar.youtube.videoCount",{count:e.userDetails.statistics.videoCount}))+" ")],1),t("li",[t("k-icon",{attrs:{type:"users"}}),e._v(" "+e._s(e.$t("socialstar.youtube.subscriberCount",{count:e.userDetails.statistics.subscriberCount}))+" ")],1)])])]:e._e()],2)},D=[],A=r(k,R,D);const x=A.exports,B={__name:"YouTubeEmbed",props:{label:String,value:String},setup(o){return{__sfc:!0,props:o}}};var L=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("k-field",e._b({},"k-field",n.props,!1),[t("div",{staticClass:"star-youtube-embed"},[t("iframe",{attrs:{src:`https://www.youtube-nocookie.com/embed/${e.value}`,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])])},P=[],S=r(B,L,P);const U=S.exports,F={__name:"Refresh",setup(o){return{__sfc:!0}}};var T=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("k-button",{attrs:{disabled:e.isLoading,icon:e.isLoading?"loader":"refresh",variant:"filled"},on:{click:e.reload}},[e._v(" "+e._s(e.$t("socialstar.refresh"))+" ")])},I=[],N=r(F,T,I);const j=N.exports;panel.plugin("tobimori/socialstar",{fields:{"socialstar-instagram-connector":y,"socialstar-youtube-connector":x,"socialstar-youtube-embed":U},viewButtons:{"socialstar-refresh":j}})})();
